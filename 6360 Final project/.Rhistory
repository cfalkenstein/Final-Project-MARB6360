stat_density_2d(
data = bullcoord,
aes(x = "X", y = "Y", fill = ..level..),
geom = "polygon",
alpha = 0.6,
h = 0.01
) +
geom_point(
data = bullcoord,
aes(x = "X", y = "Y", size = "Bull_shark"),
color = "cyan", alpha = 0.7
) +
scale_fill_viridis_c(option = "inferno") +
coord_sf(expand = FALSE) +
theme_map() +
labs(title = "Bull Shark Catch Density in Nueces Bay System")
ggplot() +
stat_density_2d(
data = sharks,
aes(x = X, y = Y, fill = ..level..),
geom = "polygon",
alpha = 0.6,
h = c(0.01, 0.01)
) +
geom_sf(data = coast, color = "black", fill = NA, linewidth = 0.4) +
stat_density_2d(
data = bullcoord,
aes(x = "X", y = "Y", fill = ..level..),
geom = "polygon",
alpha = 0.6,
h = 0.01
) +
geom_point(
data = bullcoord,
aes(x = "X", y = "Y", size = "Bull_shark"),
color = "cyan", alpha = 0.7
) +
scale_fill_viridis_c(option = "inferno") +
coord_sf(default_crs = NULL) +
coord_sf(expand = FALSE) +
theme_map() +
labs(title = "Bull Shark Catch Density in Nueces Bay System")
ggplot() +
stat_density_2d(
data = bullcoord,
aes(x = "X", y = "Y", fill = ..level..),
geom = "polygon",
alpha = 0.6,
h = c(0.01, 0.01)
) +
geom_sf(data = coast, color = "black", fill = NA, linewidth = 0.4) +
stat_density_2d(
data = bullcoord,
aes(x = "X", y = "Y", fill = ..level..),
geom = "polygon",
alpha = 0.6,
h = 0.01
) +
geom_point(
data = bullcoord,
aes(x = "X", y = "Y", size = "Bull_shark"),
color = "cyan", alpha = 0.7
) +
scale_fill_viridis_c(option = "inferno") +
coord_sf(default_crs = NULL) +
coord_sf(expand = FALSE) +
theme_map() +
labs(title = "Bull Shark Catch Density in Nueces Bay System")
#mapping it
range(Nueces$X)
range(Nueces$Y)
ggplot(Nueces, aes(x = X, y = Y)) +
geom_point(alpha = 0.6) +
stat_density2d(aes(fill = ..level..), geom = "polygon", alpha = 0.4) +
theme_bw() +
coord_equal()
# Your coordinate ranges
xmin <- min(Nueces$X)
xmax <- max(Nueces$X)
ymin <- min(Nueces$Y)
ymax <- max(Nueces$Y)
# Add a little padding
pad <- 0.05
bbox <- st_bbox(c(xmin = xmin - pad,
xmax = xmax + pad,
ymin = ymin - pad,
ymax = ymax + pad),
crs = st_crs(4326))
# Load coastline and convert to sf
coast <- ne_coastline(scale = "medium", returnclass = "sf")
# Crop to your area
coast_crop <- st_crop(coast, bbox)
ggplot() +
geom_sf(data = coast_crop, color = "black") +
geom_point(data = Nueces, aes(x = X, y = Y, color = Species), size = 2, alpha = 0.7) +
theme_bw() +
coord_sf()
ggplot() +
geom_sf(data = coast_crop, color = "black") +
geom_point(data = Nueces, aes(x = X, y = Y, color = Bull_shark), size = 2, alpha = 0.7) +
theme_bw() +
coord_sf()
ggplot() +
geom_sf(data = coast_crop, color = "black", linewidth = 0.6) +
geom_sf(data = Nueces_sf, aes(color = Bull_shark), size = 3, alpha = 0.8) +
scale_color_gradient(low = "blue", high = "red") +
theme_bw() +
labs(title = "Bull Shark Catches in Nueces County Bay System",
color = "Catches") +
coord_sf()
# Convert your data frame to sf object
Nueces_sf <- st_as_sf(Nueces, coords = c("X", "Y"), crs = 4326)
# Load coastline
coast <- ne_coastline(scale = "medium", returnclass = "sf")
# Build bounding box around your points
bbox <- st_bbox(Nueces_sf)
pad <- 0.05  # slight zoom-out padding
bbox_expanded <- st_bbox(c(
xmin = bbox$xmin - pad,
xmax = bbox$xmax + pad,
ymin = bbox$ymin - pad,
ymax = bbox$ymax + pad
), crs = st_crs(4326))
# Crop coastline to your region
coast_crop <- st_crop(coast, bbox_expanded)
# PLOT: real map + your points
ggplot() +
geom_sf(data = coast_crop, color = "black", linewidth = 0.6) +
geom_sf(data = Nueces_sf, aes(color = Bull_shark), size = 3, alpha = 0.8) +
scale_color_gradient(low = "blue", high = "red") +
theme_bw() +
labs(title = "Bull Shark Catches in Nueces County Bay System",
color = "Catches") +
coord_sf()
# Convert your data frame to sf object
Nueces_sf <- st_as_sf(Nueces, coords = c("X", "Y"), crs = 4326)
# Load USA coastline as sf
coast <- ne_states(country = "United States of America",
returnclass = "sf")
# Convert your data frame to sf object
Nueces_sf <- st_as_sf(Nueces, coords = c("X", "Y"), crs = 4326)
# Load USA coastline as sf
coast <- ne_states(country = "United States of America",
returnclass = "sf")
install.packages("rnaturalearthhires")
install.packages("rnaturalearthhires")
library(rnaturalearthhires)
install.packages("rnaturalearthhires")
library(tigris)
library(sf)
library(ggthemes)
library(rnaturalearth)
library(rnaturalearthdata)
library(rnaturalearthhires)
library(rnaturalearthhires)
options(tigris_use_cache = TRUE)
view(Nueces)
# Convert your data frame to sf object
Nueces_sf <- st_as_sf(Nueces, coords = c("X", "Y"), crs = 4326)
# Load USA coastline as sf
coast <- ne_states(country = "United States of America",
returnclass = "sf")
# Plot real map + your points
ggplot() +
geom_sf(data = texas_crop, fill = "grey90", color = "black") +
geom_sf(data = Nueces_sf,
aes(color = Bull_shark),
size = 3, alpha = 0.8) +
scale_color_gradient(low = "blue", high = "red") +
coord_sf() +
labs(title = "Bull Shark Catches in Nueces County Bay System",
color = "Catches") +
theme_bw()
# Convert your data to sf
Nueces_sf <- st_as_sf(Nueces, coords = c("X", "Y"), crs = 4326)
# Load US states as sf
states <- ne_states(country = "United States of America", returnclass = "sf")
# Filter to Texas
texas <- states[states$name == "Texas", ]
# Crop to around your points
bbox <- st_bbox(Nueces_sf)
pad <- 0.05
texas_crop <- st_crop(
texas,
xmin = bbox$xmin - pad,
xmax = bbox$xmax + pad,
ymin = bbox$ymin - pad,
ymax = bbox$ymax + pad
)
# Load US states as sf
states <- ne_states(country = "United States of America", returnclass = "sf")
#mapping it
range(Nueces$X)
range(Nueces$Y)
ggplot(Nueces, aes(x = X, y = Y)) +
geom_point(alpha = 0.6) +
stat_density2d(aes(fill = ..level..), geom = "polygon", alpha = 0.4) +
theme_bw() +
coord_equal()
# Convert your data frame to sf object
Nueces_sf <- st_as_sf(Nueces, coords = c("X", "Y"), crs = 4326)
# Load coastline
coast <- ne_coastline(scale = "medium", returnclass = "sf")
# Build bounding box around your points
bbox <- st_bbox(Nueces_sf)
pad <- 0.05  # slight zoom-out padding
bbox_expanded <- st_bbox(c(
xmin = bbox$xmin - pad,
xmax = bbox$xmax + pad,
ymin = bbox$ymin - pad,
ymax = bbox$ymax + pad
), crs = st_crs(4326))
# Crop coastline to your region
coast_crop <- st_crop(coast, bbox_expanded)
# Convert your data frame to sf object
Nueces_sf <- st_as_sf(Nueces, coords = c("X", "Y"), crs = 4326)
# Load coastline
coast <- ne_coastline(scale = "medium", returnclass = "sf")
# Build bounding box around your points
bbox <- st_bbox(Nueces_sf)
pad <- 0.05  # slight zoom-out padding
bbox_expanded <- st_bbox(c(
xmin = bbox$xmin - pad,
xmax = bbox$xmax + pad,
ymin = bbox$ymin - pad,
ymax = bbox$ymax + pad
), crs = st_crs(4326))
# Crop coastline to your region
coast_crop <- st_crop(coast, bbox_expanded)
# Crop coastline to your region
coast_crop <- st_crop(coast, bbox_expanded)
# PLOT: real map + your points
ggplot() +
geom_sf(data = coast_crop, color = "black", linewidth = 0.6) +
geom_sf(data = Nueces_sf, aes(color = Bull_shark), size = 3, alpha = 0.8) +
scale_color_gradient(low = "blue", high = "red") +
theme_bw() +
labs(title = "Bull Shark Catches in Nueces County Bay System",
color = "Catches") +
coord_sf()
ggplot() +
geom_sf(data = coast_crop, fill = "gray90", color = "black") +
stat_density_2d(
data = Nueces,
aes(x = X, y = Y, fill = after_stat(level)),
geom = "polygon",
alpha = 0.7,
contour = TRUE
) +
scale_fill_viridis_c(option = "plasma") +
geom_point(data = Nueces, aes(x = X, y = Y), size = 1, alpha = 0.4) +
coord_sf() +
theme_bw() +
labs(title = "Bull Shark Hotspots – Corpus Christi Bay",
fill = "Density")
# view working directory
getwd()
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
#Import Dataset
TPWDgill <- read_csv("C:/Users/Cali/Downloads/TPWD gill net catch.csv")
bullength <- read_csv("C:/Users/Cali/Downloads/TPWD gill net lengths.csv")
# A tibble is created of the data
TPWDgill
view(TPWDgill)
view(bullength)
bullsfull <- TPWDgill[c("MAJOR_AREA_CODE","MINOR_AREA_CODE","STATION_CODE","COMPLETION_DTTM","X","Y","START_TEMPERATURE_NUM","START_SALINITY_NUM",
"START_TURBIDITY_NUM","START_DISSOLVED_OXYGEN_NUM", "start_shallow_water_depth_num","start_deep_water_depth_num", "ELAPSED_TIME", "SEASON", "Bull_shark")]
bullsfull
bullnozero <- filter(bullsfull, Bull_shark > 0)
bullnozero
view(bullnozero)
Nueces <- bullnozero %>%
filter(MINOR_AREA_CODE == 260)
Nueces
# uncount sharks into individual rows
Nueces <- Nueces %>%
uncount(weights = Bull_shark)
# Add Species_Name and Species_code columns
Nueces <- Nueces %>%
mutate(Species_Name = "Bull_shark",
Species_code = 755)
Nueces
#Aransas Data
Aransas <- bullnozero %>%
filter(MINOR_AREA_CODE == 370)
Aransas
# uncount sharks into individual rows
Aransas <- Aransas %>%
uncount(weights = Bull_shark)
# Add Species_Name and Species_code columns
Aransas <- Aransas %>%
mutate(Species_Name = "Bull_shark",
Species_code = 755)
Aransas
Stationnueces <- Nueces %>%
count(STATION_CODE, name = "Num_Captures") %>%
arrange(desc(Num_Captures))
Stationnueces
ggplot(Stationnueces, aes(x = STATION_CODE, y = Num_Captures)) + geom_bar(stat = "identity") + theme_bw() + labs(title = "Number of Captures Nueces' Stations")
Lengthstation <- Nueces %>%
count(LENGTH_NUM, name = "Length_Captures") %>%
arrange(desc(Length_Captures))
ggplot(Stationnueces, aes(x = STATION_CODE, y = Num_Captures)) + geom_bar(stat = "identity") + theme_bw() + labs(title = "Number of Captures Nueces' Stations")
dat <- read.csv("C:/Users/Cali/Downloads/TPWD gill net catch.csv", stringsAsFactors = FALSE)
# Parse day-month-year hour:minute:second
dat$COMPLETION_DTTM <- dmy_hms(dat$COMPLETION_DTTM)
# Create separate columns
dat$YEAR  <- year(dat$COMPLETION_DTTM)
ggplot(Stationnueces, aes(x = STATION_CODE, y = Num_Captures)) + geom_bar(stat = "identity") + theme_bw() + labs(title = "Number of Captures Nueces' Stations")
dat <- read.csv("C:/Users/Cali/Downloads/TPWD gill net catch.csv", stringsAsFactors = FALSE)
# Parse day-month-year hour:minute:second
dat$COMPLETION_DTTM <- dmy_hms(dat$COMPLETION_DTTM)
# Create separate columns
dat$YEAR  <- year(dat$COMPLETION_DTTM)
dat$MONTH <- month(dat$COMPLETION_DTTM)
dat$DAY   <- day(dat$COMPLETION_DTTM)
dat$TIME  <- format(dat$COMPLETION_DTTM, "%H:%M:%S")
dat <- dat %>% arrange(YEAR)
view(dat)
bullabundance <- ggplot(dat, aes(x = COMPLETION_DTTM, y = Bull_shark)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic() + labs(title = "Shark abundance over time")
bullabundance
Nueces$COMPLETION_DTTM <- dmy_hms(Nueces$COMPLETION_DTTM)
# Create separate columns
Nueces$YEAR  <- year(Nueces$COMPLETION_DTTM)
Nueces$MONTH <- month(Nueces$COMPLETION_DTTM)
Nueces$DAY   <- day(Nueces$COMPLETION_DTTM)
Nueces$TIME  <- format(Nueces$COMPLETION_DTTM, "%H:%M:%S")
Nueces <- Nueces %>% arrange(YEAR)
#add p-value
m <- lm(Bull_shark ~ COMPLETION_DTTM, data = Nueces)
pval <- summary(m)$coefficients[2,4]
Nueces
view(Nueces)
#Now measure abundance in Nueces and Aransas Counties
Nueces <- bullnozero %>%
filter(MINOR_AREA_CODE == 260)
Nueces$COMPLETION_DTTM <- dmy_hms(Nueces$COMPLETION_DTTM)
# Create separate columns
Nueces$YEAR  <- year(Nueces$COMPLETION_DTTM)
Nueces$MONTH <- month(Nueces$COMPLETION_DTTM)
Nueces$DAY   <- day(Nueces$COMPLETION_DTTM)
Nueces$TIME  <- format(Nueces$COMPLETION_DTTM, "%H:%M:%S")
Nueces <- Nueces %>% arrange(YEAR)
view(Nueces)
#add p-value
m <- lm(Bull_shark ~ COMPLETION_DTTM, data = Nueces)
pval <- summary(m)$coefficients[2,4]
view(Nueces)
Nueces <- Nueces %>% arrange(YEAR)
#add p-value
m <- lm(Bull_shark ~ COMPLETION_DTTM, data = Nueces)
pval <- summary(m)$coefficients[2,4]
bullnueces <- ggplot(Nueces, aes(x = COMPLETION_DTTM, y = Bull_shark)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
annotate("text", x = Inf, y = Inf, label = paste0("p = ", signif(pval, 3)),
hjust = 1.5, vjust = 1) +
theme_classic() +
labs(title = "Shark abundance Nueces over time")
bullnueces
Aransas <- bullnozero %>%
filter(MINOR_AREA_CODE == 370)
Aransas$COMPLETION_DTTM <- dmy_hms(Aransas$COMPLETION_DTTM)
# Create separate columns
Aransas$YEAR  <- year(Aransas$COMPLETION_DTTM)
Aransas$MONTH <- month(Aransas$COMPLETION_DTTM)
Aransas$DAY   <- day(Aransas$COMPLETION_DTTM)
Aransas$TIME  <- format(Aransas$COMPLETION_DTTM, "%H:%M:%S")
Aransas <- Aransas %>% arrange(YEAR)
m <- lm(Bull_shark ~ COMPLETION_DTTM, data = Aransas)
pval <- summary(m)$coefficients[2,4]
view(Aransas)
bullaransas <- ggplot(Aransas, aes(x = COMPLETION_DTTM, y = Bull_shark)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic() + labs(title = "Shark abundance Aransas over time") + annotate("text", x = Inf, y = Inf, label = paste0("p = ", signif(pval, 3)), hjust = 1.5, vjust = 1)
bullaransas
salinty <- ggplot(bullnozero, aes(x = START_SALINITY_NUM, y = Bull_shark)) + geom_line(aes(color = SEASON)) + labs(title = "Shark CPUE based on Salinity")
salinty
tempbull <- ggplot(bullnozero, aes(x = START_TEMPERATURE_NUM, y = Bull_shark)) + geom_line(aes(color = SEASON)) + labs(title = "Shark CPUE based on Temperature")
tempbull
seasonplot <- ggplot(Nueces, aes(x = SEASON, y = Bull_shark)) + geom_bar(stat = "identity") + theme_classic()
seasonplot
soaktime <- ggplot(Nueces, aes(x = ELAPSED_TIME, y = Bull_shark)) + geom_point() + theme_classic()
soaktime
Station.counts <- Nueces %>%
count(STATION_CODE, name = "Num_Captures") %>%
arrange(desc(Num_Captures))
Station.counts
Stationplot <- ggplot(Nueces, aes(x = STATION_CODE, y = Bull_shark)) + geom_bar(stat = "identity") + theme_classic() + labs(title = "Station Abundance")
Stationplot
#What does this look like on a map?
install.packages("rnaturalearth")
install.packages("rnaturalearth")
library(tigris)
library(sf)
library(ggthemes)
library(rnaturalearth)
library(rnaturalearthdata)
library(rnaturalearthhires)
library(rnaturalearthdata)
options(tigris_use_cache = TRUE)
view(Nueces)
coast <- ne_coastline(scale = "medium", returnclass = "sf")
nuecesonmap <- counties(state = "TX", cb = TRUE) %>%
filter(NAME == "Nueces") %>%
st_as_sf()
bullcoord <- st_as_sf(nuecesonmap,
coords = c("X", "Y"),
crs = 4326,
remove = "FALSE")
bullcoord
#mapping it
range(Nueces$X)
range(Nueces$Y)
ggplot(Nueces, aes(x = X, y = Y)) +
geom_point(alpha = 0.6) +
stat_density2d(aes(fill = ..level..), geom = "polygon", alpha = 0.4) +
theme_bw() +
coord_equal()
ggplot() +
geom_sf(data = coast_crop, fill = "gray90", color = "black") +
stat_density_2d(
data = Nueces,
aes(x = X, y = Y, fill = after_stat(level)),
geom = "polygon",
alpha = 0.7,
contour = TRUE
) +
scale_fill_viridis_c(option = "plasma") +
geom_point(data = Nueces, aes(x = X, y = Y), size = 1, alpha = 0.4) +
coord_sf() +
theme_bw() +
labs(title = "Bull Shark Hotspots – Corpus Christi Bay",
fill = "Density")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(rstudioapi)
library(janitor)
library(ggplot2)
library(maps)
library(leaflet)
library(dplyr)
library(tidyr)
library(lubridate)
ggplot() +
geom_sf(data = Nueces, fill = "gray90", color = "black") +
stat_density_2d(
data = Nueces,
aes(x = X, y = Y, fill = after_stat(level)),
geom = "polygon",
alpha = 0.7,
contour = TRUE
) +
scale_fill_viridis_c(option = "plasma") +
geom_point(data = Nueces, aes(x = X, y = Y), size = 1, alpha = 0.4) +
coord_sf() +
theme_bw() +
labs(title = "Bull Shark Hotspots – Corpus Christi Bay",
fill = "Density")
ggplot() +
geom_sf(data = Nueces, fill = "gray90", color = "black") +
stat_density_2d(
data = Nueces,
aes(x = X, y = Y, fill = after_stat(level)),
geom = "polygon",
alpha = 0.7,
contour = TRUE
) +
scale_fill_viridis_c(option = "plasma") +
geom_point(data = Nueces, aes(x = X, y = Y), size = 1, alpha = 0.4) +
coord_sf() +
theme_bw() +
labs(title = "Bull Shark Hotspots – Corpus Christi Bay",
fill = "Density")
ggplot() +
geom_sf(data = coast_crop, fill = "gray90", color = "black") +
stat_density_2d(
data = Nueces,
aes(x = X, y = Y, fill = after_stat(level)),
geom = "polygon",
alpha = 0.7,
contour = TRUE
) +
scale_fill_viridis_c(option = "plasma") +
geom_point(data = Nueces, aes(x = X, y = Y), size = 1, alpha = 0.4) +
coord_sf() +
theme_bw() +
labs(title = "Bull Shark Hotspots – Corpus Christi Bay",
fill = "Density")
#mapping it
range(Nueces$X)
range(Nueces$Y)
ggplot(Nueces, aes(x = X, y = Y)) +
geom_point(alpha = 0.6) +
stat_density2d(aes(fill = ..level..), geom = "polygon", alpha = 0.4) +
theme_bw() +
coord_equal()
ggplot() +
geom_sf(data = coast_crop, fill = "gray90", color = "black") +
stat_density_2d(
data = Nueces,
aes(x = X, y = Y, fill = after_stat(level)),
geom = "polygon",
alpha = 0.7,
contour = TRUE
) +
scale_fill_viridis_c(option = "plasma") +
geom_point(data = Nueces, aes(x = X, y = Y), size = 1, alpha = 0.4) +
coord_sf() +
theme_bw() +
labs(title = "Bull Shark Hotspots – Corpus Christi Bay",
fill = "Density")
